<section class="flex-1 flex flex-col bg-white">
    @if (selectedEmail()) {
    <header class="border-b border-gray-200 p-4 space-y-1">
        <h3 class="text-lg font-semibold">
            {{ selectedEmail().subject }}
        </h3>

        <!-- Owner -->
        <p class="text-xs text-gray-500">
            Owner:
            {{ selectedEmail().assigned_to || 'No Owner' }}
        </p>

        <!-- Date / From / To -->
        <div class="flex flex-col gap-1 text-xs text-gray-500">
            <div>
                <strong>From:</strong>
                {{ selectedEmail().from_email }}
            </div>
            <div>
                <strong>Date:</strong>
                {{ selectedEmail().updated_at | date:'medium' }}
            </div>
            <div>
                <strong>To:</strong>
                {{ selectedEmail().to_email }}
            </div>
        </div>
    </header>

    <main class="flex-1 overflow-auto p-4 space-y-4">
        <p>{{ selectedEmail().body }}</p>

        <div>
            <h4 class="mb-2 font-semibold">Comments</h4>
            @for (comment of comments(); track comment.id) {
            <div class="mb-2 rounded bg-gray-100 p-2">
                {{ comment.comment }}
            </div>
            }
            <textarea [(ngModel)]="newComment" placeholder="Add a comment" class="w-full rounded border p-2"></textarea>
            <button (click)="addComment()" class="mt-2 rounded bg-blue-600 px-3 py-1 text-white">Add
                Comment</button>
        </div>

        <div class="mt-4">
            <h4 class="mb-2 font-semibold">Assign</h4>
            <div class="flex items-center gap-2">
                <input [(ngModel)]="assignTo" placeholder="Assign to user id" class="flex-1 rounded border p-2" />
                <button (click)="assign()" class="rounded bg-green-600 px-3 py-1 text-white">Assign</button>
            </div>
        </div>
    </main>
    } @else {
    <div class="flex flex-1 items-center justify-center text-gray-400">Select an email to view its content</div>
    }
</section>